# Debug test for list building in functions

def build_list_simple():
    print("=== build_list_simple ===")
    result = []
    result.append(1)
    result.append(2)
    result.append(3)
    print("Built: len=" + str(len(result)))
    print("result[0]=" + str(result[0]))
    print("result[1]=" + str(result[1]))
    print("result[2]=" + str(result[2]))
    return result
end

def build_list_loop():
    print("=== build_list_loop ===")
    result = []
    i = 0
    while i < 5:
        result.append(i * 10)
        i += 1
    end
    print("Built: len=" + str(len(result)))
    j = 0
    while j < len(result):
        print("result[" + str(j) + "]=" + str(result[j]))
        j += 1
    end
    return result
end

def map_test(arr):
    print("=== map_test ===")
    print("Input len=" + str(len(arr)))
    result = []
    i = 0
    while i < len(arr):
        val = arr[i]
        print("  arr[" + str(i) + "]=" + str(val))
        doubled = val * 2
        print("  doubled=" + str(doubled))
        result.append(doubled)
        print("  appended, result len=" + str(len(result)))
        i += 1
    end
    print("Final result len=" + str(len(result)))
    return result
end

def product_test(arr):
    print("=== product_test ===")
    print("Input: len=" + str(len(arr)))
    prod = 1
    i = 0
    while i < len(arr):
        val = arr[i]
        print("  arr[" + str(i) + "]=" + str(val) + ", prod before=" + str(prod))
        prod = prod * val
        print("  prod after=" + str(prod))
        i += 1
    end
    return prod
end

def main():
    print("LIST BUILD DEBUG TEST")
    print("=" * 40)
    print("")
    
    # Test 1: Simple build
    r1 = build_list_simple()
    print("")
    
    # Test 2: Loop build
    r2 = build_list_loop()
    print("")
    
    # Test 3: Map function
    input_arr = [1, 2, 3, 4, 5]
    print("Creating input array...")
    print("input_arr len=" + str(len(input_arr)))
    j = 0
    while j < len(input_arr):
        print("input_arr[" + str(j) + "]=" + str(input_arr[j]))
        j += 1
    end
    print("")
    
    mapped = map_test(input_arr)
    print("")
    print("Mapped result:")
    k = 0
    while k < len(mapped):
        print("mapped[" + str(k) + "]=" + str(mapped[k]))
        k += 1
    end
    print("")
    
    # Test 4: Product
    small = [1, 2, 3, 4, 5]
    print("Product of [1,2,3,4,5]:")
    p = product_test(small)
    print("Final product=" + str(p))
    print("")
    
    print("=" * 40)
    print("DEBUG COMPLETE")
end