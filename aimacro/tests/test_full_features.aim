# test_full_features.aim
# Comprehensive feature test - validates punch list items

def test_sorted():
    print("=== SORTED TEST ===")
    arr = [5, 2, 8, 1, 9, 3]
    result = sorted(arr)
    print("Input: [5,2,8,1,9,3]")
    print("Sorted:")
    for x in result:
        print(x)
    end
    # Verify first and last
    if result[0] == 1 and result[-1] == 9:
        print("PASS: sorted() works!")
    else:
        print("FAIL: sorted() broken")
    end
end

def test_operators():
    print("=== OPERATOR TEST ===")
    
    # Power
    x = 2 ** 10
    print("2**10 =", x)
    
    # Floor div
    y = 17 // 5
    print("17//5 =", y)
    
    # Negative floor div
    z = -17 // 5
    print("-17//5 =", z)
    
    # Power assign
    a = 2
    a **= 3
    print("2 **= 3 ->", a)
    
    # Floor div assign
    b = 100
    b //= 7
    print("100 //= 7 ->", b)
    
    if x == 1024 and y == 3 and a == 8:
        print("PASS: operators work!")
    else:
        print("FAIL: operator issue")
    end
end

def test_list_ops():
    print("=== LIST OPS TEST ===")
    
    arr = [10, 20, 30, 40, 50]
    
    # Basic access
    print("arr[0] =", arr[0])
    print("arr[-1] =", arr[-1])
    
    # Slicing
    slice1 = arr[1:4]
    print("arr[1:4] length:", len(slice1))
    
    # pop with index
    val = arr.pop(2)
    print("pop(2) returned:", val)
    print("len after pop:", len(arr))
    
    # append
    arr.append(99)
    print("After append(99), last:", arr[-1])
    
    # index
    idx = arr.index(20)
    print("index(20) =", idx)
    
    # count
    arr.append(20)
    cnt = arr.count(20)
    print("count(20) =", cnt)
    
    # in operator
    if 40 in arr:
        print("40 in arr: True")
    end
    
    if 999 not in arr:
        print("999 not in arr: True")
    end
    
    print("PASS: list ops work!")
end

def test_string_ops():
    print("=== STRING OPS TEST ===")
    
    s = "Hello World"
    
    # Indexing
    print("s[0] =", s[0])
    print("s[-1] =", s[-1])
    
    # Slicing
    print("s[0:5] =", s[0:5])
    print("s[6:] =", s[6:])
    
    # Methods
    print("upper:", s.upper())
    print("lower:", s.lower())
    
    # Concat
    a = "foo"
    b = "bar"
    c = a + b
    print("concat:", c)
    
    # Repeat
    d = "x" * 5
    print("repeat:", d)
    
    # Comparison
    if "abc" == "abc":
        print("string == works")
    end
    
    if "abc" != "def":
        print("string != works")
    end
    
    # find
    pos = s.find("World")
    print("find('World') =", pos)
    
    # split/join
    parts = "a,b,c".split(",")
    print("split count:", len(parts))
    
    joined = "-".join(parts)
    print("joined:", joined)
    
    print("PASS: string ops work!")
end

def test_control_flow():
    print("=== CONTROL FLOW TEST ===")
    
    # for range variations
    print("range(3):")
    for i in range(3):
        print(i)
    end
    
    print("range(2,5):")
    for i in range(2, 5):
        print(i)
    end
    
    print("range(0,10,3):")
    for i in range(0, 10, 3):
        print(i)
    end
    
    # while with break/continue
    print("evens 0-8 (continue/break):")
    i = 0
    while i < 20:
        if i % 2 == 1:
            i += 1
            continue
        end
        if i > 8:
            break
        end
        print(i)
        i += 1
    end
    
    print("PASS: control flow works!")
end

def test_builtins():
    print("=== BUILTINS TEST ===")
    
    arr = [3, 1, 4, 1, 5, 9, 2, 6]
    
    print("len:", len(arr))
    print("sum:", sum(arr))
    print("min:", min(1, 5))
    print("max:", max(1, 5))
    print("abs(-42):", abs(-42))
    
    # str/int conversion
    n = 123
    s = str(n)
    print("str(123):", s)
    
    back = int("456")
    print("int('456'):", back)
    
    # ord/chr
    print("ord('A'):", ord("A"))
    print("chr(66):", chr(66))
    
    # bool
    print("bool(0):", bool(0))
    print("bool(1):", bool(1))
    
    # any/all
    print("any([0,0,1]):", any([0, 0, 1]))
    print("all([1,1,1]):", all([1, 1, 1]))
    print("all([1,0,1]):", all([1, 0, 1]))
    
    # reversed
    rev = reversed([1, 2, 3])
    print("reversed [1,2,3]:", rev[0], rev[1], rev[2])
    
    print("PASS: builtins work!")
end

def test_nested_calls():
    print("=== NESTED CALLS TEST ===")
    
    # This tests the call flattening
    arr = [5, 3, 8, 1]
    result = max(min(arr[0], arr[1]), arr[2])
    print("max(min(5,3), 8) =", result)
    
    # Nested in condition
    if len(arr) > 2 and arr[0] > 0:
        print("nested condition works")
    end
    
    print("PASS: nested calls work!")
end

def main():
    print("##################################")
    print("# AIMACRO FULL FEATURE TEST")
    print("##################################")
    print("")
    
    test_sorted()
    print("")
    
    test_operators()
    print("")
    
    test_list_ops()
    print("")
    
    test_string_ops()
    print("")
    
    test_control_flow()
    print("")
    
    test_builtins()
    print("")
    
    test_nested_calls()
    print("")
    
    print("##################################")
    print("# ALL TESTS COMPLETE")
    print("##################################")
end