# =============================================================================
# AIMACRO EDGE CASE & BUG HUNTING TEST SUITE
# Specifically targets potential compiler issues and boundary conditions
# =============================================================================

# -----------------------------------------------------------------------------
# EDGE CASE 1: Empty constructs
# -----------------------------------------------------------------------------

def empty_function():
    return 0
end

def function_with_only_assignment():
    x = 5
    return x
end

def empty_loops():
    count = 0
    for i in range(0):
        count = count + 1
    end
    
    j = 0
    while j > 100:
        count = count + 1
        j = j + 1
    end
    
    return count
end

# -----------------------------------------------------------------------------
# EDGE CASE 2: Single iteration boundaries
# -----------------------------------------------------------------------------

def single_iteration():
    count = 0
    for i in range(1):
        count = count + 1
    end
    
    j = 0
    while j < 1:
        count = count + 1
        j = j + 1
    end
    
    return count
end

def range_variations():
    results = []
    
    c1 = 0
    for i in range(3):
        c1 += 1
    end
    results.append(c1)
    
    c2 = 0
    for i in range(2, 5):
        c2 += 1
    end
    results.append(c2)
    
    c3 = 0
    for i in range(0, 10, 2):
        c3 += 1
    end
    results.append(c3)
    
    return results
end

# -----------------------------------------------------------------------------
# EDGE CASE 3: Deeply nested structures
# -----------------------------------------------------------------------------

def deeply_nested_if(x):
    if x > 0:
        if x > 10:
            if x > 100:
                if x > 1000:
                    return 4
                else:
                    return 3
                end
            else:
                return 2
            end
        else:
            return 1
        end
    else:
        return 0
    end
end

def deeply_nested_loops():
    count = 0
    for a in range(2):
        for b in range(2):
            for c in range(2):
                for d in range(2):
                    count = count + 1
                end
            end
        end
    end
    return count
end

def mixed_nesting():
    total = 0
    for i in range(3):
        if i % 2 == 0:
            for j in range(2):
                if j == 0:
                    total += 1
                else:
                    total += 2
                end
            end
        else:
            total += 10
        end
    end
    return total
end

# -----------------------------------------------------------------------------
# EDGE CASE 4: Long elif chains
# -----------------------------------------------------------------------------

def long_elif_chain(x):
    if x == 1:
        return "one"
    elif x == 2:
        return "two"
    elif x == 3:
        return "three"
    elif x == 4:
        return "four"
    elif x == 5:
        return "five"
    elif x == 6:
        return "six"
    elif x == 7:
        return "seven"
    elif x == 8:
        return "eight"
    elif x == 9:
        return "nine"
    elif x == 10:
        return "ten"
    else:
        return "other"
    end
end

def elif_with_complex_conditions(a, b, c):
    if a > b and b > c:
        return 1
    elif a > c and c > b:
        return 2
    elif b > a and a > c:
        return 3
    elif b > c and c > a:
        return 4
    elif c > a and a > b:
        return 5
    elif c > b and b > a:
        return 6
    else:
        return 0
    end
end

# -----------------------------------------------------------------------------
# EDGE CASE 5: Return in various positions
# -----------------------------------------------------------------------------

def return_in_loop():
    for i in range(100):
        if i == 5:
            return i
        end
    end
    return -1
end

def return_in_nested_loop():
    for i in range(10):
        for j in range(10):
            if i * j == 25:
                return i * 100 + j
            end
        end
    end
    return -1
end

def multiple_return_paths(x, y):
    if x < 0:
        if y < 0:
            return -1
        end
        return -2
    end
    if y < 0:
        return -3
    end
    return x + y
end

# -----------------------------------------------------------------------------
# EDGE CASE 6: Augmented assignment edge cases
# -----------------------------------------------------------------------------

def augmented_in_loops():
    total = 0
    for i in range(10):
        total += i
    end
    
    product = 1
    for i in range(1, 5):
        product *= i
    end
    
    return total * 1000 + product
end

def augmented_in_conditions():
    x = 10
    if x > 5:
        x += 5
    end
    if x > 10:
        x *= 2
    end
    return x
end

# -----------------------------------------------------------------------------
# EDGE CASE 7: List boundary conditions
# -----------------------------------------------------------------------------

def list_boundary_test():
    arr = []
    
    for i in range(5):
        arr.append(i)
    end
    
    first = arr[0]
    last = arr[4]
    
    arr[0] = 100
    arr[4] = 400
    
    return arr[0] + arr[4]
end

def list_in_list_context():
    arr = [3, 1, 4, 1, 5]
    total = sum_list(arr)
    return total
end

def sum_list(arr):
    total = 0
    for i in range(len(arr)):
        total += arr[i]
    end
    return total
end

def modify_list_in_function(arr):
    arr[0] = 999
    arr.append(888)
    return len(arr)
end

# -----------------------------------------------------------------------------
# EDGE CASE 8: String concatenation chains
# -----------------------------------------------------------------------------

def long_concat_chain():
    result = "a" + "b" + "c" + "d" + "e" + "f" + "g" + "h"
    return result
end

def concat_with_str_conversion():
    x = 123
    y = 456
    result = "x=" + str(x) + ", y=" + str(y) + ", sum=" + str(x + y)
    return result
end

def concat_in_loop():
    result = ""
    for i in range(5):
        result = result + str(i) + "-"
    end
    return result
end

def mixed_string_ops():
    base = "test"
    repeated = base * 3
    extended = repeated + "!"
    final = ">>>" + extended + "<<<"
    return final
end

# -----------------------------------------------------------------------------
# EDGE CASE 9: Expression complexity in various contexts
# -----------------------------------------------------------------------------

def complex_return():
    return (1 + 2) * (3 + 4) - (5 - 6) * (7 - 8)
end

def complex_assignment():
    x = ((10 + 20) * (30 - 10)) / ((5 + 5) * 2)
    return x
end

def complex_condition_test():
    a = 5
    b = 10
    c = 15
    
    if (a + b > c) and (b - a < c) or (a * b == c * 2 + 20):
        return 1
    end
    return 0
end

def nested_function_calls():
    result = add_nums(multiply_nums(2, 3), multiply_nums(4, 5))
    return result
end

def add_nums(a, b):
    return a + b
end

def multiply_nums(a, b):
    return a * b
end

def triple_nested_calls():
    return add_nums(add_nums(1, 2), add_nums(3, 4))
end

# -----------------------------------------------------------------------------
# EDGE CASE 10: While loop variations
# -----------------------------------------------------------------------------

def while_immediate_exit():
    count = 0
    x = 0
    while x > 0:
        count = count + 1
        x = x - 1
    end
    return count
end

def while_with_break_at_start():
    count = 0
    while 1 == 1:
        break
    end
    return count
end

def while_decrement():
    n = 10
    count = 0
    while n > 0:
        count = count + 1
        n = n - 1
    end
    return count
end

def while_complex_update():
    n = 100
    steps = 0
    while n > 1:
        if n % 2 == 0:
            n = n / 2
        else:
            n = n * 3 + 1
        end
        steps = steps + 1
        if steps > 1000:
            break
        end
    end
    return steps
end

# -----------------------------------------------------------------------------
# EDGE CASE 11: Parameter edge cases  
# -----------------------------------------------------------------------------

def many_params(a, b, c, d, e, f, g, h):
    return a + b + c + d + e + f + g + h
end

def single_param(x):
    return x * 2
end

def no_params():
    return 42
end

def param_modification(x):
    x = x + 1
    x = x * 2
    return x
end

# -----------------------------------------------------------------------------
# MAIN TEST RUNNER
# -----------------------------------------------------------------------------

def main():
    print("=" * 60)
    print("AIMACRO EDGE CASE TEST SUITE")
    print("=" * 60)
    print("")
    
    print("--- Empty Constructs ---")
    print("empty_function(): " + str(empty_function()))
    print("empty_loops(): " + str(empty_loops()))
    print("")
    
    print("--- Single Iteration ---")
    print("single_iteration(): " + str(single_iteration()))
    print("Expected: 2")
    ranges = range_variations()
    print("range_variations():")
    print("  range(3): " + str(ranges[0]))
    print("  range(2,5): " + str(ranges[1]))
    print("  range(0,10,2): " + str(ranges[2]))
    print("")
    
    print("--- Deep Nesting ---")
    print("deeply_nested_if(500): " + str(deeply_nested_if(500)))
    print("Expected: 3")
    print("deeply_nested_loops(): " + str(deeply_nested_loops()))
    print("Expected: 16")
    print("mixed_nesting(): " + str(mixed_nesting()))
    print("Expected: 16")
    print("")
    
    print("--- Elif Chains ---")
    print("long_elif_chain(7): " + long_elif_chain(7))
    print("Expected: seven")
    print("elif_complex(5,3,1): " + str(elif_with_complex_conditions(5, 3, 1)))
    print("")
    
    print("--- Return Positions ---")
    print("return_in_loop(): " + str(return_in_loop()))
    print("Expected: 5")
    print("return_in_nested_loop(): " + str(return_in_nested_loop()))
    print("Expected: 505")
    print("multiple_return_paths(3, -1): " + str(multiple_return_paths(3, -1)))
    print("Expected: -3")
    print("")
    
    print("--- Augmented Assignment ---")
    print("augmented_in_loops(): " + str(augmented_in_loops()))
    print("Expected: 45024")
    print("augmented_in_conditions(): " + str(augmented_in_conditions()))
    print("Expected: 30")
    print("")
    
    print("--- List Boundaries ---")
    print("list_boundary_test(): " + str(list_boundary_test()))
    print("Expected: 500")
    
    arr = [3, 1, 4, 1, 5]
    print("sum_list([3,1,4,1,5]): " + str(sum_list(arr)))
    print("Expected: 14")
    
    mod_arr = [1, 2, 3]
    new_len = modify_list_in_function(mod_arr)
    print("modify_list result:")
    print("  New length: " + str(new_len))
    print("  First element: " + str(mod_arr[0]))
    print("")
    
    print("--- String Chains ---")
    print("long_concat_chain(): " + long_concat_chain())
    print("concat_with_str(): " + concat_with_str_conversion())
    print("concat_in_loop(): " + concat_in_loop())
    print("mixed_string_ops(): " + mixed_string_ops())
    print("")
    
    print("--- Complex Expressions ---")
    print("complex_return(): " + str(complex_return()))
    print("Expected: 20")
    print("complex_assignment(): " + str(complex_assignment()))
    print("Expected: 30")
    print("nested_function_calls(): " + str(nested_function_calls()))
    print("Expected: 26")
    print("triple_nested_calls(): " + str(triple_nested_calls()))
    print("Expected: 10")
    print("")
    
    print("--- While Variations ---")
    print("while_immediate_exit(): " + str(while_immediate_exit()))
    print("Expected: 0")
    print("while_with_break_at_start(): " + str(while_with_break_at_start()))
    print("Expected: 0")
    print("while_decrement(): " + str(while_decrement()))
    print("Expected: 10")
    print("while_complex_update(): " + str(while_complex_update()))
    print("")
    
    print("--- Parameter Edge Cases ---")
    print("many_params(1..8): " + str(many_params(1, 2, 3, 4, 5, 6, 7, 8)))
    print("Expected: 36")
    print("single_param(21): " + str(single_param(21)))
    print("Expected: 42")
    print("no_params(): " + str(no_params()))
    print("Expected: 42")
    print("param_modification(5): " + str(param_modification(5)))
    print("Expected: 12")
    print("")
    
    print("=" * 60)
    print("EDGE CASE TESTS COMPLETE!")
    print("=" * 60)
end